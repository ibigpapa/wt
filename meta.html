<html>
    <head>
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container" id="output">
            
        </div>
        <py-script>
import json

import js
from pyodide.http import open_url

github_page_base = "https://ibigpapa.github.io/wt/"

flags_path = f"{github_page_base}flags/1x1/"

# category icons
air_icon = "&#x2708;"
tank_icon = "&#x1F69C;"
aa_icon = "&#x1F4E1;"


#flags
flag_size_const = 20
countries_short_names = [
    "us",
    "de",
    "ru",
    "gb",
    "jp",
    "cn",
    "it",
    "fr",
    "se",
    "il",
]
flag_icons = {key: f"{flags_path}{key}.svg" for key in countries_short_names}

data_url = f"{github_page_base}data.json"

def get_data():
    try:
        raw = open_url(data_url).getvalue()
        return json.loads(raw)
    except Exception as e:
        print(e)
        return None


def create_flag(short_name):
    child = document.createElement("img")
    child.src = flag_icons[short_name]
    child.alt = short_name
    child.width = flag_size_const
    child.height = flag_size_const
    return child

def create_row(id):
    child = document.createElement("div")
    child.className = "row"
    child.id = id
    return child

def create_col(id):
    child = document.createElement("div")
    child.className = "col"
    child.id = id
    return child

def create_ul_list(vics, category, vics_dict):
    ul = document.createElement("ul")
    for vic in vics:
        li = document.createElement("li")
        span = document.createElment("span")
        span.innerText = vic
        if vic not in vics_dict[category]:
            js.console.log(f"{vic}: not in vics dict")
        else:
            img = create_flag(vics_dict[category][vic])
            li.appendChild(img)
        li.appendChild(span)
            
data = get_data()
container = document.querySelector("#output")
container.appendChild(create_ul_list(data["meta"]["br4.3"]["air"], "air", data["vehicles"]))

        </py-script>
    </body>
</html>
